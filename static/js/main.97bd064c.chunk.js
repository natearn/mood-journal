(this["webpackJsonpmood-journal"]=this["webpackJsonpmood-journal"]||[]).push([[0],{128:function(e,n,t){"use strict";t.r(n);var r,a=t(0),u=t.n(a),c=t(58),s=t.n(c),o=t(63),i=t(15),j=t(157),d=t(158),l=t(26),b=t(99),f=t(152),O=t(155),v=t(89),x=t.n(v),h=t(90),y=t.n(h),p=t(91),m=t.n(p),k=t(92),g=t.n(k),C=t(93),w=t.n(C),D=t(1),S={1:Object(D.jsx)(x.a,{}),2:Object(D.jsx)(y.a,{}),3:Object(D.jsx)(m.a,{}),4:Object(D.jsx)(g.a,{}),5:Object(D.jsx)(w.a,{})},Q=function(e){var n=e.value,t=Object(b.a)(e,["value"]);return Object(D.jsx)("span",Object(l.a)(Object(l.a)({},t),{},{children:S[n]}))},N=function(e){var n=e.ask,t=e.onChange;return Object(D.jsxs)("fieldset",{children:[Object(D.jsx)(O.a,{component:"legend",children:n}),Object(D.jsx)(f.a,{name:"mood-rating",IconContainerComponent:Q,highlightSelectedOnly:!0,onChange:function(e,n){return t(n)}})]})},I=t(156),M=t(161),Y=t(94),P=t.n(Y),F=t(95),q=t.n(F),B=function(e){var n=e.ask,t=e.onChange,r=Object(a.useState)(null),u=Object(i.a)(r,2),c=u[0],s=u[1];return Object(a.useEffect)((function(){t(c)}),[t,c]),Object(D.jsxs)("fieldset",{children:[Object(D.jsx)(O.a,{component:"legend",children:n}),Object(D.jsxs)(I.a,{value:c,onChange:function(e,n){return s(n)},exclusive:!0,"aria-label":"yes or no",children:[Object(D.jsx)(M.a,{value:!0,"aria-label":"yes",children:Object(D.jsx)(P.a,{})}),Object(D.jsx)(M.a,{value:!1,"aria-label":"no",children:Object(D.jsx)(q.a,{})})]})]})},E=t(22),J=t(34),A=t.n(J),L=t(43),R=t(98);!function(e){e.YesNo="YesNo",e.Mood="Mood"}(r||(r={}));var T=function(){return Object(R.a)("mood-joural",1,{upgrade:function(e,n){n<1&&(e.createObjectStore("surveys",{keyPath:"id",autoIncrement:!0}),e.createObjectStore("responses",{keyPath:"id",autoIncrement:!0}).createIndex("survey","survey"))}})},W=function(){var e=Object(L.a)(A.a.mark((function e(n){var t,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return t=e.sent,e.next=5,n(t);case 5:return r=e.sent,e.next=8,t.close();case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),H=function(e){return W((function(n){return n.add("responses",Object(l.a)(Object(l.a)({},e),{},{created:new Date}))}))},K=function(e){return W((function(n){return n.getAllFromIndex("responses","survey",IDBKeyRange.only(e))}))},z=function(e){return Object(E.useQuery)(["surveys",e],(function(){return n=e,W((function(e){return e.get("surveys",n)}));var n}))},G=function(){return Object(E.useQuery)(["surveys"],(function(){return W((function(e){return e.getAll("surveys")}))}),{placeholderData:[]})},U=function(e){return Object(E.useQuery)(["responses",e,"latest"],(function(){return K(e).then((function(e){return e.slice(-1)[0]}))}))},V=function(e){var n=e.question,t=e.onChange;switch(n.kind){case r.YesNo:return Object(D.jsx)(B,{ask:n.ask,onChange:t},n.ask);case r.Mood:return Object(D.jsx)(N,{ask:n.ask,onChange:t},n.ask);default:return null}},X=function(e){var n=Number(e.id),t=z(n).data,r=U(n).data,u=function(){var e=Object(E.useQueryClient)();return Object(E.useMutation)(H,{onSuccess:function(n,t){return e.invalidateQueries(["responses",t.survey])}})}().mutate,c=Object(a.useState)({survey:n,answers:[]}),s=Object(i.a)(c,2),o=s[0],l=s[1];return Object(D.jsx)(j.a,{maxWidth:"md",children:Object(D.jsxs)("form",{onSubmit:function(e){e.preventDefault(),u(o)},children:[null===t||void 0===t?void 0:t.questions.map((function(e,n){return Object(D.jsx)(V,{question:e,onChange:(t=n,function(e){l((function(n){return n.answers[t]=e,n}))})},e.ask);var t})),Object(D.jsx)(d.a,{type:"submit",children:"Submit"}),Object(D.jsxs)("p",{children:["latest response: ",null===r||void 0===r?void 0:r.created.toString()]})]})})},Z=t(160),$=t(153),_=t(151),ee=t(159),ne=function(e){var n=e.name,t=e.id;return Object(D.jsx)($.a,{children:Object(D.jsx)(_.a,{component:o.a,to:"/survey/".concat(t),children:Object(D.jsx)(ee.a,{primary:n})})},n)},te=function(e){var n=G().data;return Object(D.jsx)(j.a,{maxWidth:"sm",children:Object(D.jsx)("nav",{"aria-label":"survey list",children:Object(D.jsx)(Z.a,{children:null===n||void 0===n?void 0:n.map(ne)})})})},re=function(){return Object(D.jsxs)(o.b,{children:[Object(D.jsx)(X,{path:"/survey/:id"}),Object(D.jsx)(te,{default:!0})]})},ae=t(96),ue=[{id:1,name:"Daily Mood Journal",questions:[{kind:r.YesNo,ask:"Did you eat breakfast today?"},{kind:r.YesNo,ask:"Did you go outside today?"},{kind:r.YesNo,ask:"Did you exercise today?"},{kind:r.YesNo,ask:"Did you talk to a friend today?"},{kind:r.YesNo,ask:"Did you complete a chore today?"},{kind:r.Mood,ask:"How are you feeling today?"}]}],ce=function(){var e=Object(L.a)(A.a.mark((function e(){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return n=e.sent,e.next=5,n.clear("surveys");case 5:return e.next=7,Promise.all(ue.map((function(e){return n.put("surveys",e)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(E.useQueryClient)(),n=Object(E.useMutation)(ce,{onSuccess:function(){return e.invalidateQueries()}}).mutate;return Object(a.useEffect)((function(){n()}),[n]),null},oe=new E.QueryClient,ie=function(){return Object(D.jsxs)(E.QueryClientProvider,{client:oe,children:[Object(D.jsx)(se,{}),Object(D.jsx)(re,{}),Object(D.jsx)(ae.ReactQueryDevtools,{})]})},je=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,162)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,u=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),u(e),c(e)}))};s.a.render(Object(D.jsx)(u.a.StrictMode,{children:Object(D.jsx)(ie,{})}),document.getElementById("root")),je()}},[[128,1,2]]]);
//# sourceMappingURL=main.97bd064c.chunk.js.map